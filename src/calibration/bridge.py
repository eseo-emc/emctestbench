from utility.quantities import PowerRatio,Power
import numpy

calibrationFrequencies = numpy.arange(9e3,6e9,10e6)  
bridgeInsertionTransfer = PowerRatio([ 0.77377226,  0.699627  ,  0.68171492,  0.66715284,  0.6528385 ,
    0.63686549,  0.62742583,  0.61976625,  0.61183938,  0.6065615 ,
    0.59856803,  0.59101899,  0.58320297,  0.57573591,  0.57454421,
    0.56930211,  0.56087989,  0.55734073,  0.5541857 ,  0.55022131,
    0.54365057,  0.53797769,  0.5346004 ,  0.5297434 ,  0.5256879 ,
    0.51914849,  0.51721117,  0.51405784,  0.51240904,  0.50885039,
    0.50409637,  0.5016644 ,  0.49969871,  0.49654926,  0.49018715,
    0.48622925,  0.48599726,  0.48168789,  0.47641704,  0.47098436,
    0.4703122 ,  0.46981328,  0.47072797,  0.46810864,  0.46477557,
    0.46126926,  0.45842818,  0.45597721,  0.4545125 ,  0.45014589,
    0.4480279 ,  0.44685202,  0.44270546,  0.43971416,  0.44058746,
    0.43912964,  0.43719734,  0.43533378,  0.43293799,  0.43043401,
    0.42889044,  0.42403341,  0.42087771,  0.42002703,  0.41928612,
    0.41795525,  0.4156365 ,  0.41425072,  0.4125984 ,  0.41056645,
    0.41019195,  0.40804212,  0.40579518,  0.40292409,  0.40044138,
    0.39547593,  0.39533723,  0.3949974 ,  0.39322898,  0.390273  ,
    0.38912678,  0.38920368,  0.38573706,  0.38357044,  0.3841785 ,
    0.3817882 ,  0.37816086,  0.37563778,  0.37286311,  0.37271634,
    0.37366686,  0.37191958,  0.36794951,  0.36877682,  0.36886645,
    0.36461269,  0.36064161,  0.3566981 ,  0.35641544,  0.35670498,
    0.35221682,  0.35231334,  0.35469875,  0.35571912,  0.35161013,
    0.34785967,  0.34603967,  0.34801134,  0.34613582,  0.33896131,
    0.3345763 ,  0.33419888,  0.33453514,  0.32574992,  0.31743673,
    0.31629791,  0.32003873,  0.32168438,  0.31680175,  0.31062466,
    0.30756191,  0.30601878,  0.30204135,  0.29634109,  0.29208322,
    0.28816739,  0.28017435,  0.26705203,  0.25725614,  0.25431392,
    0.25585194,  0.25179031,  0.23858921,  0.22464764,  0.21699143,
    0.21605028,  0.21391384,  0.20764422,  0.19946932,  0.19356317,
    0.1913003 ,  0.19023599,  0.1929887 ,  0.19878969,  0.20025403,
    0.1955668 ,  0.19380836,  0.20268533,  0.21821547,  0.23105787,
    0.23430607,  0.23425726,  0.23802416,  0.24407674,  0.24845364,
    0.25120792,  0.2532601 ,  0.25262227,  0.2489367 ,  0.24672029,
    0.24912142,  0.25289264,  0.25450804,  0.2492635 ,  0.24241711,
    0.24158729,  0.24581808,  0.24878753,  0.24924928,  0.24687656,
    0.24105283,  0.23230575,  0.22286705,  0.21315819,  0.20484216,
    0.2027609 ,  0.20036613,  0.19635149,  0.1934791 ,  0.18984697,
    0.18804774,  0.18749894,  0.17886594,  0.16437055,  0.15264524,
    0.14173881,  0.13142534,  0.12450198,  0.12084334,  0.11844668,
    0.11602417,  0.11689191,  0.12038601,  0.12797538,  0.13877035,
    0.1465332 ,  0.14904169,  0.14816983,  0.14636031,  0.14872083,
    0.15357093,  0.15554952,  0.16017477,  0.17047394,  0.18230356,
    0.19265943,  0.20183361,  0.21026017,  0.21400315,  0.21095365,
    0.20681344,  0.20385991,  0.2052474 ,  0.21118021,  0.21506793,
    0.21751362,  0.22094032,  0.22477185,  0.228195  ,  0.23052405,
    0.23113412,  0.22867999,  0.2272633 ,  0.23046166,  0.23169568,
    0.23122426,  0.23457814,  0.23628021,  0.23418051,  0.2338945 ,
    0.23491298,  0.23462697,  0.2361128 ,  0.23739635,  0.23733357,
    0.23877755,  0.23870779,  0.23805905,  0.23871477,  0.23817066,
    0.2352199 ,  0.23306833,  0.23449443,  0.23588957,  0.23553381,
    0.23635695,  0.23677551,  0.2369499 ,  0.23720801,  0.23816367,
    0.23941428,  0.23944944,  0.23884731,  0.23819856,  0.23562451,
    0.23552683,  0.23622441,  0.23458512,  0.23184125,  0.2271943 ,
    0.22575187,  0.23009424,  0.23316538,  0.232999  ,  0.23340803,
    0.23324164,  0.23270784,  0.23124506,  0.23046859,  0.23026755,
    0.22960201,  0.2285552 ,  0.22653865,  0.22625569,  0.2284928 ,
    0.22885331,  0.22848588,  0.22922765,  0.22802246,  0.22386775,
    0.22049994,  0.22149769,  0.22350197,  0.22313621,  0.22330874,
    0.22151145,  0.22045866,  0.22259175,  0.22484087,  0.22388846,
    0.22287395,  0.2231086 ,  0.22268121,  0.21738986,  0.21284907,
    0.21526716,  0.21798152,  0.21706012,  0.21294524,  0.20885264,
    0.21376958,  0.21756866,  0.2174036 ,  0.21737611,  0.21651741,
    0.21692272,  0.21711507,  0.21558315,  0.21401688,  0.21549386,
    0.21666854,  0.21372838,  0.21144798,  0.2115853 ,  0.21327498,
    0.21481377,  0.21506106,  0.21446342,  0.21336427,  0.2105554 ,
    0.21000614,  0.21114589,  0.21174323,  0.21135874,  0.20936072,
    0.2050963 ,  0.20309748,  0.20450558,  0.20708123,  0.20743824,
    0.20572823,  0.20506196,  0.20513063,  0.20559771,  0.20653874,
    0.20647692,  0.20522681,  0.20440255,  0.20251363,  0.19812409,
    0.19527257,  0.19655469,  0.1983343 ,  0.19958843,  0.19599418,
    0.18685288,  0.18694319,  0.19472612,  0.19562286,  0.19392046,
    0.19465605,  0.19665276,  0.19828524,  0.19698907,  0.19321288,
    0.19098506,  0.18766566,  0.18473478,  0.18400264,  0.18660278,
    0.1899581 ,  0.19293965,  0.19352114,  0.189972  ,  0.18493556,
    0.18654721,  0.19068381,  0.19207095,  0.19296767,  0.19290462,
    0.19150347,  0.19062076,  0.18995117,  0.1882353 ,  0.18540794,
    0.18363658,  0.18549824,  0.18644995,  0.1856858 ,  0.18448612,
    0.1843687 ,  0.18259365,  0.18007958,  0.18030058,  0.18025225,
    0.17870762,  0.1766496 ,  0.17213716,  0.17072825,  0.17377974,
    0.17583739,  0.1742887 ,  0.17157359,  0.17072138,  0.17316808,
    0.17386221,  0.17039148,  0.16891384,  0.17024714,  0.1709138 ,
    0.16992412,  0.16897569,  0.16905817,  0.16946366,  0.16964235,
    0.16750482,  0.163532  ,  0.16052724,  0.16217897,  0.16553902,
    0.1655734 ,  0.16215822,  0.15866128,  0.15969101,  0.16361447,
    0.16380005,  0.16110777,  0.15888934,  0.15891007,  0.15958734,
    0.15896536,  0.15717476,  0.15770475,  0.15945603,  0.15907592,
    0.15511846,  0.15164325,  0.15272297,  0.15782488,  0.15879257,
    0.15636921,  0.15426345,  0.15395958,  0.15422812,  0.15415744,
    0.15354975,  0.15403026,  0.15521032,  0.15481462,  0.15456729,
    0.15298443,  0.15126663,  0.15051334,  0.14996234,  0.14890218,
    0.14778623,  0.14640873,  0.14566873,  0.14613209,  0.14563415,
    0.14357141,  0.14161435,  0.13861204,  0.13844682,  0.13991306,
    0.14180107,  0.14185639,  0.14098004,  0.14042244,  0.13942431,
    0.13751065,  0.13612014,  0.13464215,  0.13284128,  0.13317121,
    0.13263508,  0.13092357,  0.12945373,  0.12733982,  0.12450903,
    0.12315814,  0.1202664 ,  0.11644074,  0.11759989,  0.11948783,
    0.11793304,  0.11774564,  0.1175027 ,  0.1144417 ,  0.11388883,
    0.11375098,  0.11047055,  0.10896129,  0.10980897,  0.10766108,
    0.10558398,  0.10416027,  0.10054857,  0.09751052,  0.09648218,
    0.09224568,  0.08905423,  0.09062231,  0.09073974,  0.08792133,
    0.08798349,  0.08729962,  0.0847675 ,  0.08328799,  0.08145017,
    0.07821753,  0.07648971,  0.07405896,  0.07081774,  0.07084536,
    0.06504142,  0.06162516,  0.06025844,  0.05919163,  0.05582484,
    0.05585434,  0.05841746,  0.05828849,  0.05843603,  0.05951123,
    0.05845219,  0.05908098,  0.06026404,  0.05758299,  0.0574742 ,
    0.05695054,  0.05178609,  0.05211298,  0.05797409,  0.05863937,
    0.05793696,  0.06019665,  0.0585098 ,  0.05791521,  0.06199173,
    0.06369144,  0.06430153,  0.06820946,  0.06872179,  0.06853213,
    0.07285057,  0.0743941 ,  0.0723237 ,  0.07232538,  0.06814063,
    0.06359979,  0.06662706,  0.07314442,  0.07530137,  0.07532253,
    0.07530157,  0.07412979,  0.0732926 ,  0.07364968,  0.07393541,
    0.07464021,  0.07547707,  0.07512247,  0.07611949,  0.07944666,
    0.08152044,  0.08031038,  0.07776319,  0.07315084,  0.06800407,
    0.06689649,  0.07003769,  0.07315116,  0.07364062,  0.07188525,
    0.06978915,  0.06919656,  0.06734393,  0.06517429,  0.06483664,
    0.06326668,  0.05983082,  0.06138792,  0.06720422,  0.0695419 ,
    0.06859702,  0.06562705,  0.05963862,  0.05745316,  0.05732366,
    0.05456696,  0.05413577,  0.05532386,  0.05117269,  0.04842111,
    0.05026711,  0.04954168,  0.0475726 ,  0.04824256,  0.04684664,
    0.04430298,  0.04737453,  0.05424693,  0.05735417,  0.05892572,
    0.05896095,  0.05567517,  0.05426582,  0.05269837,  0.04934907])
bridgeCouplingFactor = PowerRatio([  1.72135711e-02,   2.16362094e-02,   2.19088868e-02,
     2.17756906e-02,   1.89422893e-02,   2.24209123e-02,
     1.93128106e-02,   1.83612658e-02,   2.18644447e-02,
     1.86638673e-02,   1.93839115e-02,   2.02049793e-02,
     1.72963517e-02,   1.92670183e-02,   1.96496887e-02,
     1.86469863e-02,   1.91689679e-02,   1.74044870e-02,
     1.84203935e-02,   1.97340141e-02,   1.94027337e-02,
     2.01685441e-02,   1.73982918e-02,   1.71036011e-02,
     1.84358917e-02,   1.63942078e-02,   1.76504920e-02,
     1.80595743e-02,   1.65896680e-02,   1.79194109e-02,
     1.66750403e-02,   1.66460204e-02,   1.75675150e-02,
     1.63202722e-02,   1.80089758e-02,   1.63649364e-02,
     1.53508216e-02,   1.79526925e-02,   1.64887789e-02,
     1.83679366e-02,   1.91521570e-02,   1.54278626e-02,
     1.69812828e-02,   1.62645723e-02,   1.52465820e-02,
     1.67349720e-02,   1.51676871e-02,   1.59114117e-02,
     1.56094265e-02,   1.51237886e-02,   1.68965299e-02,
     1.53099424e-02,   1.58539955e-02,   1.62853890e-02,
     1.42513396e-02,   1.53517303e-02,   1.56483145e-02,
     1.58151916e-02,   1.69549753e-02,   1.63717170e-02,
     1.58927374e-02,   1.51238037e-02,   1.55840468e-02,
     1.55760848e-02,   1.42783924e-02,   1.48087370e-02,
     1.42278862e-02,   1.38064969e-02,   1.46836468e-02,
     1.50660331e-02,   1.51920872e-02,   1.45258885e-02,
     1.45809048e-02,   1.40203346e-02,   1.34567493e-02,
     1.52457818e-02,   1.48962645e-02,   1.47678916e-02,
     1.57602541e-02,   1.46677222e-02,   1.51090909e-02,
     1.49848189e-02,   1.47351163e-02,   1.43173054e-02,
     1.26370435e-02,   1.36459945e-02,   1.30366905e-02,
     1.26769327e-02,   1.52481875e-02,   1.34940869e-02,
     1.34714179e-02,   1.42202521e-02,   1.28455907e-02,
     1.41893862e-02,   1.37117384e-02,   1.37735756e-02,
     1.40905338e-02,   1.24305572e-02,   1.46730867e-02,
     1.45309504e-02,   1.38125203e-02,   1.56865036e-02,
     1.21138807e-02,   1.20285745e-02,   1.30973621e-02,
     1.17142587e-02,   1.37080099e-02,   1.35872557e-02,
     1.28048350e-02,   1.26612534e-02,   1.13979062e-02,
     1.36567215e-02,   1.38889794e-02,   1.31889669e-02,
     1.45225416e-02,   1.13155895e-02,   1.12413800e-02,
     1.36101053e-02,   1.35056366e-02,   1.53572988e-02,
     1.42668760e-02,   1.15039083e-02,   1.09989345e-02,
     1.13353814e-02,   1.29007411e-02,   1.36408180e-02,
     1.28492329e-02,   1.22325453e-02,   1.04171244e-02,
     1.03963229e-02,   1.38207517e-02,   1.50359542e-02,
     1.35052126e-02,   1.19279352e-02,   9.84711768e-03,
     1.00487772e-02,   1.35347985e-02,   1.59214591e-02,
     1.39020329e-02,   1.11195116e-02,   9.84429567e-03,
     1.05899538e-02,   1.29679217e-02,   1.49864577e-02,
     1.23595855e-02,   9.51867986e-03,   9.90121300e-03,
     1.15316447e-02,   1.21360600e-02,   1.44240287e-02,
     1.29668641e-02,   1.02380011e-02,   1.04089176e-02,
     1.14053983e-02,   1.22129072e-02,   1.25448171e-02,
     1.26602351e-02,   1.14355065e-02,   9.82391332e-03,
     1.13701963e-02,   1.24523729e-02,   1.13075149e-02,
     1.30057914e-02,   1.12682505e-02,   8.89742571e-03,
     1.09275305e-02,   1.22537376e-02,   1.07882848e-02,
     1.14366939e-02,   1.19496232e-02,   1.08371957e-02,
     1.04972838e-02,   1.21534922e-02,   1.17502603e-02,
     9.77484148e-03,   1.20232085e-02,   1.23452594e-02,
     9.23895004e-03,   1.17754744e-02,   1.20697740e-02,
     9.27095369e-03,   1.21402613e-02,   1.24681782e-02,
     9.28782837e-03,   1.09197163e-02,   1.33167427e-02,
     1.01150255e-02,   9.80693263e-03,   1.26997643e-02,
     1.08301414e-02,   1.01174296e-02,   1.35681328e-02,
     1.06626931e-02,   8.41694409e-03,   1.17971979e-02,
     1.14150263e-02,   8.95972033e-03,   1.22032424e-02,
     1.08787142e-02,   8.16014206e-03,   1.09494566e-02,
     1.10981693e-02,   9.02605324e-03,   1.05191818e-02,
     1.20750770e-02,   9.49134083e-03,   8.61996975e-03,
     1.04241202e-02,   9.81154645e-03,   9.42274820e-03,
     1.25907213e-02,   1.01582389e-02,   8.23470102e-03,
     1.04197873e-02,   1.01331055e-02,   9.24487288e-03,
     1.09708668e-02,   1.03106062e-02,   8.72282291e-03,
     9.16739890e-03,   1.01040938e-02,   9.29263856e-03,
     9.40582516e-03,   1.16788891e-02,   1.05745032e-02,
     8.82481524e-03,   9.62637646e-03,   9.51564150e-03,
     9.06127086e-03,   1.07882246e-02,   1.06661885e-02,
     8.70033906e-03,   8.90942792e-03,   9.65497009e-03,
     8.96092718e-03,   9.31528954e-03,   1.01601619e-02,
     9.22328893e-03,   8.74806556e-03,   9.36111369e-03,
     9.02420514e-03,   8.56366472e-03,   1.01135275e-02,
     1.09930844e-02,   9.41388249e-03,   9.32217868e-03,
     9.19974753e-03,   8.39939780e-03,   9.29560476e-03,
     9.82448641e-03,   9.42778456e-03,   9.04496966e-03,
     8.99326013e-03,   9.09342540e-03,   8.33926540e-03,
     8.82067180e-03,   9.71003191e-03,   8.61544430e-03,
     9.13112063e-03,   8.98007489e-03,   7.75072188e-03,
     8.83093001e-03,   9.94120896e-03,   9.91359889e-03,
     9.88509362e-03,   9.31020928e-03,   8.68131900e-03,
     7.90588779e-03,   8.52314575e-03,   9.35205990e-03,
     8.68542080e-03,   9.25960783e-03,   9.09176144e-03,
     7.90689006e-03,   7.93119906e-03,   8.59877889e-03,
     9.14294429e-03,   8.97621813e-03,   8.62153297e-03,
     8.08217995e-03,   7.20267625e-03,   8.40548077e-03,
     9.94050721e-03,   9.42958670e-03,   1.02622117e-02,
     9.28062661e-03,   7.40735428e-03,   7.91264417e-03,
     8.00142010e-03,   8.50312671e-03,   9.38563282e-03,
     8.63628148e-03,   8.43014544e-03,   7.34590364e-03,
     7.30283457e-03,   9.21491808e-03,   8.73524406e-03,
     8.56764970e-03,   8.69656812e-03,   6.82212041e-03,
     7.18322460e-03,   8.44864891e-03,   8.82011421e-03,
     1.03861657e-02,   9.58111663e-03,   8.27706753e-03,
     7.57822422e-03,   7.04462041e-03,   8.04498431e-03,
     8.34504071e-03,   8.54721726e-03,   8.66624247e-03,
     7.21155017e-03,   6.94140011e-03,   7.78742703e-03,
     8.20202432e-03,   8.44425594e-03,   8.28952781e-03,
     7.82837923e-03,   6.85470290e-03,   6.93761440e-03,
     8.17943297e-03,   8.84102332e-03,   9.41785216e-03,
     8.93131027e-03,   7.78000497e-03,   7.41384540e-03,
     7.58620698e-03,   7.42555252e-03,   7.79204139e-03,
     8.42645043e-03,   7.64891062e-03,   7.16953578e-03,
     7.50242404e-03,   7.44286594e-03,   7.87410908e-03,
     7.79478760e-03,   7.74387030e-03,   7.76485020e-03,
     6.55253433e-03,   7.00291263e-03,   8.36183587e-03,
     7.67925187e-03,   8.97447843e-03,   8.56233932e-03,
     7.31703553e-03,   8.42554439e-03,   7.04335664e-03,
     6.33057817e-03,   7.97666434e-03,   7.07249768e-03,
     7.75442650e-03,   8.01625369e-03,   6.71340303e-03,
     7.50656269e-03,   6.63980545e-03,   6.70168513e-03,
     8.48065317e-03,   6.74268833e-03,   6.74824623e-03,
     7.55317267e-03,   6.61366455e-03,   7.88521894e-03,
     7.98244611e-03,   7.66961852e-03,   8.99484268e-03,
     7.39422513e-03,   6.35976496e-03,   6.47738822e-03,
     6.55589095e-03,   7.76310003e-03,   7.79613827e-03,
     7.42144250e-03,   7.10771147e-03,   6.03764761e-03,
     6.40384341e-03,   7.38919634e-03,   7.19120251e-03,
     7.11520450e-03,   6.46897709e-03,   6.55279508e-03,
     6.55938345e-03,   6.72168832e-03,   7.98168614e-03,
     8.26921351e-03,   7.99084136e-03,   7.14211768e-03,
     5.32524786e-03,   6.06341957e-03,   7.09367875e-03,
     7.07478052e-03,   7.91526482e-03,   6.85564596e-03,
     5.87352954e-03,   6.10057511e-03,   6.37920023e-03,
     7.04931934e-03,   7.02106227e-03,   6.10827646e-03,
     6.19526859e-03,   5.72462022e-03,   5.59319424e-03,
     7.03250074e-03,   7.82906283e-03,   7.90840569e-03,
     7.29839495e-03,   5.57105918e-03,   5.26887422e-03,
     6.39029625e-03,   6.69720357e-03,   7.10881616e-03,
     7.10563920e-03,   5.77819317e-03,   5.53224904e-03,
     6.00849315e-03,   6.27660300e-03,   6.81143809e-03,
     6.20131324e-03,   5.75760400e-03,   5.74143595e-03,
     4.80178712e-03,   5.29471349e-03,   6.82538315e-03,
     6.89828102e-03,   7.13021190e-03,   5.93421348e-03,
     5.00283404e-03,   5.71124918e-03,   6.05771117e-03,
     6.45700797e-03,   6.90068142e-03,   6.00918743e-03,
     5.50312823e-03,   5.47806732e-03,   5.67067008e-03,
     5.96531122e-03,   5.70010613e-03,   5.47522140e-03,
     5.23944419e-03,   4.40652134e-03,   4.18630790e-03,
     4.83815846e-03,   5.59412501e-03,   5.95408735e-03,
     5.55211207e-03,   4.89807465e-03,   4.72474296e-03,
     5.24545778e-03,   5.69368878e-03,   5.98344543e-03,
     6.23836749e-03,   5.75559102e-03,   5.28238103e-03,
     5.19652481e-03,   4.97483665e-03,   4.81397657e-03,
     4.73260247e-03,   4.52802745e-03,   3.75522008e-03,
     2.96200792e-03,   2.85712871e-03,   3.50260726e-03,
     4.30587583e-03,   4.53589663e-03,   4.36842601e-03,
     4.17165751e-03,   3.86954695e-03,   4.27131904e-03,
     4.89023318e-03,   5.24206764e-03,   5.74938218e-03,
     5.34057783e-03,   4.70094406e-03,   4.19053271e-03,
     3.36836097e-03,   3.40054899e-03,   3.50630431e-03,
     2.53307071e-03,   1.70922328e-03,   1.11890648e-03,
     1.00517459e-03,   1.65942296e-03,   2.13315495e-03,
     2.31651594e-03,   2.34418524e-03,   2.14835651e-03,
     2.12159798e-03,   2.50222945e-03,   3.30531107e-03,
     4.26454962e-03,   4.59584765e-03,   4.15773530e-03,
     3.79391216e-03,   2.78246506e-03,   2.19365371e-03,
     2.20309160e-03,   1.80866251e-03,   1.19077705e-03,
     6.88467873e-04,   1.01968987e-04,   1.87122514e-04,
     4.22962024e-04,   1.01329125e-03,   9.76839757e-04,
     8.06778170e-04,   1.15631566e-03,   1.51102980e-03,
     3.25977681e-03,   5.77195558e-03,   8.13579418e-03,
     9.50688533e-03,   9.98384707e-03,   8.30103520e-03,
     6.63845257e-03,   5.88796654e-03,   6.20170855e-03,
     6.89279464e-03,   6.34862196e-03,   5.16571769e-03,
     3.63401818e-03,   1.82119766e-03,   4.96350379e-04,
     3.19139817e-04,   2.83800992e-04,   7.52270280e-05,
     4.70279747e-04,   3.67853851e-04,   1.95665761e-03,
     5.02625635e-03,   8.56102556e-03,   1.13358156e-02,
     1.05856174e-02,   8.70896627e-03,   6.93358090e-03,
     7.10379778e-03,   9.69706699e-03,   1.10200490e-02,
     1.06711259e-02,   9.11760526e-03,   5.92318661e-03,
     3.29759676e-03,   1.45134957e-03,   1.01583668e-03,
     1.33937292e-03,   1.40294030e-03,   6.61713795e-04,
     2.20753557e-04,   1.41961971e-03,   4.65982681e-03,
     7.80292899e-03,   9.91231186e-03,   9.60555399e-03,
     7.80892643e-03,   6.37516457e-03,   7.70457622e-03,
     1.07656162e-02,   1.25201681e-02,   1.18126542e-02,
     8.77419460e-03,   5.21559168e-03,   2.33352629e-03,
     8.14024557e-04,   8.08918770e-04,   1.00452494e-03,
     1.02933467e-03,   3.12459757e-04,   3.34868352e-04,
     1.84914136e-03,   5.28854716e-03,   8.71575592e-03,
     1.12258653e-02,   1.04599795e-02,   8.19937523e-03,
     7.23283529e-03,   8.44031058e-03,   1.22021498e-02,
     1.33659046e-02,   1.15692452e-02,   9.22190533e-03,
     5.51082562e-03,   2.21913473e-03,   7.48185042e-04,
     8.77500548e-05,   2.82949078e-04,   8.69200183e-04,
     1.95131298e-04,   5.67439024e-04,   1.39876309e-03,
     4.08536284e-03,   8.78647591e-03,   1.20297979e-02,
     1.10370039e-02,   9.82995217e-03,   7.80762760e-03,
     8.45328132e-03,   1.15713342e-02,   1.26756117e-02,
     1.27897955e-02,   1.12415003e-02,   8.32215609e-03])
def bridgeInsertionTransferAt(frequency):
    return PowerRatio(numpy.interp(frequency,calibrationFrequencies,bridgeInsertionTransfer))
def bridgeCouplingFactorAt(frequency):
    return PowerRatio(numpy.interp(frequency,calibrationFrequencies,bridgeCouplingFactor))

class BridgeCalibration(object):
    def __init__(self):
        from device import knownDevices
        self.switchPlatform = knownDevices['switchPlatform']
        self.wattMeter = knownDevices['wattMeter']
        self.rfGenerator = knownDevices['rfGenerator']
    def _measureInsertionLoss(self):
        '''
        Connect power meter A to the reference plane.
        '''
        testPower = Power(10,'dBm')
        self.rfGenerator.setPower(testPower)
        insertionTransfer = []
        for frequency in self.calibrationFrequencies:
            self.rfGenerator.setFrequency(frequency)
            incidentPower = self.wattMeter.getPower(1)
            insertionTransfer += [incidentPower/testPower]
        print numpy.array(insertionTransfer)
        return insertionTransfer
        self.rfGenerator.enableOutput(False)
    def _measureCouplingFactor(self):
        '''
        Connect a reflective standard at the reference plane
        '''
        testPower = Power(15,'dBm')
        self.rfGenerator.setPower(testPower)
        couplingFactor = []
        for frequency in self.calibrationFrequencies:
            self.rfGenerator.setFrequency(frequency)
            reflectedPower = self.wattMeter.getPower(2)
            couplingFactor += [reflectedPower/(testPower*bridgeInsertionTransferAt(frequency))]
        print numpy.array(couplingFactor)
        return couplingFactor
        self.rfGenerator.enableOutput(False)
    
if __name__ == '__main__':
    calibration = BridgeCalibration()
    calibration.switchPlatform.setPreset('bridge')
    
#    insertionTransfer = calibration._measureInsertionLoss()
#    couplingFactor = calibration._measureCouplingFactor()
#    print insertionTransfer
#    print str(couplingFactor)
